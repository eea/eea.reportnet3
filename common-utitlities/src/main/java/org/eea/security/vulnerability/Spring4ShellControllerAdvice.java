package org.eea.security.vulnerability;

import org.springframework.core.annotation.Order;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.InitBinder;
import org.springframework.web.bind.WebDataBinder;

/**
 * Spring 4 shell vulnerability controller advice
 */
@ControllerAdvice
@Order(10000)
public class Spring4ShellControllerAdvice {


  /**
   * Set allowed fields.
   *
   * @param dataBinder the data binder
   */
  @InitBinder
  public void setAllowedFields(WebDataBinder dataBinder){

    String[]abd=new String[]{"class.*","Class.*","*.class.*","*.Class.*"};

    dataBinder.setDisallowedFields(abd);

  }
}
