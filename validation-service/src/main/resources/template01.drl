template header
ruleid
dataSchemaId
schemaName
typevalidation
whencondition
messageFailValidation
typeFailValidation
originName
package src.main.resources

import org.eea.validation.persistence.data.domain.*;
import org.eea.interfaces.vo.validation.*;
import org.eea.interfaces.vo.dataset.*;
import org.eea.validation.util.*;
import java.util.regex.*;
import java.util.*;
import org.apache.commons.lang3.StringUtils;
import java.text.ParseException;
import java.text.SimpleDateFormat;

template "templateValidateRules"
rule "@{ruleid}"
dialect "java"
  when
    dataValidate : @{typevalidation}(@{schemaName}.equals("@{dataSchemaId}") && @{whencondition});
  then
   ValidationRuleDrools.fillValidation(dataValidate, "@{messageFailValidation}","@{typeFailValidation}","@{ruleid}","@{originName}");


end

end template

//////////////////////////////////////////DEFAULT VALIDATIONS////////////////////////////////////////////////////////////

//////////////////////////////////////////VALIDATION CODELIST////////////////////////////////////////////////////////////
function boolean isCodeList( String value ,Long codeList){
	if(!isBlank(value)){
		value = "";
	}
	return CodeListUtils.codeListValidate(value,codeList);
}

//////////////////////////////////////////VALIDATION EMPTY VALUE////////////////////////////////////////////////////////////
function boolean isBlank(String value){
	return !StringUtils.isBlank(value);
} 


//////////////////////////////////////////VALIDATION BOOLEAN////////////////////////////////////////////////////////////
function boolean isBoolean(String value){
	if(null == value || (!value.equalsIgnoreCase("TRUE") && !value.equalsIgnoreCase("FALSE"))){
		return false;
	}
		return true;
} 

//////////////////////////////////////////VALIDATION DATE////////////////////////////////////////////////////////////
function boolean isDateYYYYMMDD( String value ){
 SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
 Date dateDrools = null;
    try {
      sdf.setLenient(false);
      dateDrools = sdf.parse(value);
    } catch( Exception e ){
        return false;
    }
    
    return true;
}

//////////////////////////////////////////VALIDATION NUMBER///////////////////////////////////////////////////////////
function boolean isNumber(String value){
    try {
    	String aux = value.replace(".","");
    	aux = aux.replace(",",".");
        Double.valueOf( aux );
        return true;
    } catch( Exception e ){
        return false;        
    }
 }

//////////////////////////////////////////VALIDATION LATITUDE///////////////////////////////////////////////////////////
function boolean isCordenateLat( String value ){
	if(!isBlank(value)){
		value = "";
	}
   if (value.contains(",")){
   	value = value.replace(",",".");
   }
   if(isNumber(value)){
    	return Double.valueOf(value) >= -90 && Double.valueOf(value) <= 90;
   }
   return false;
}  

//////////////////////////////////////////VALIDATION LONGITUDE///////////////////////////////////////////////////////////
function boolean isCordenateLong( String value ){	
	if(!isBlank(value)){
		value = "";
	}
   if (value.contains(",")){
   	value = value.replace(",",".");
   }
   if(isNumber(value)){
    	return Double.valueOf(value) >= -180 && Double.valueOf(value) <= 180;
   }
   return false;
 }

 //////////////////////////////////////////DEFAULT VALIDATIONS END BLOCK////////////////////////////////////////////////////////////
